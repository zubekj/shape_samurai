#:set color_line (237.0 / 255.0, 212.0 / 255.0, 157.0 / 255.0, 1)
#:set color_a (3.0 / 255.0, 164.0 / 255.0, 119 / 255.0, 0.5)
#:set color_b (172.0 / 255.0, 2 / 255.0, 183.0 / 255.0, 0.5)
#:set color_top (26.0 / 255.0, 35.0 / 255.0, 126.0 / 255.0)

RootLayout:
    drawing_container: drawing_container_id

    orientation: "vertical" 
    BoxLayout:
        id: top_layout
        orientation: "horizontal"
        size_hint: 1, None
        height: 150
        canvas.before:
            Color:
                rgb: color_top
            Rectangle:
                size: self.size
                pos: self.pos
        AnchorLayout:
            size_hint: 0.2, 1.0
            anchor_x: "left"
            Label:
                text: "Score: {0:03d}".format(root.score)
                font_size: 24
        BoxLayout:
            orientation: "vertical"
            size_hint: 1.0, 1.0
            Label:
                text: root.msg_text
                font_size: 20
            Widget:
                size_hint: 1.0, None
                height: 10
                canvas:
                    Color:
                        rgb: color_a
                    Rectangle:
                        pos: self.x + 0.5*self.width, self.y+5
                        size: 0.5*self.width*max(0, root.distance*10), 10
                    Color:
                        rgb: color_b
                    Rectangle:
                        pos: self.x + 0.5*self.width * (1+min(root.distance*10, 0)), self.y+5
                        size: 0.5*self.width*abs(min(root.distance*10, 0)), 10
                    Color:
                        rgb: (0.8, 0.8, 0.8)
                    Line:
                        points: self.x + 0.5*self.width, self.y, self.x + 0.5*self.width, self.y+20 
                        width: 2
                    Line:
                        points: self.x, self.y, self.x, self.y+20 
                        width: 2
                    Line:
                        points: self.x + self.width, self.y, self.x + self.width, self.y+20 
                        width: 2
        AnchorLayout:
            size_hint: 0.2, 1.0
            anchor_x: "right"
            Label:
                text: "Time: {0:03d}".format(root.clock_time)
                font_size: 24
    AnchorLayout:
        id: bottom_layout
        size_hint: 1, 0.8
        canvas.before:
            Rectangle:
                size: self.size
                pos: self.pos
                source: "Samurai.png"
        Widget:
            id: drawing_container_id
            size_hint: 0.8, 0.8
            on_pos: root.refresh_players() or root.refresh_shapes()
            on_size: root.refresh_players() or root.refresh_shapes()
            canvas:
                Color:
                    rgb: color_line
                Line:
                    points: root.line_a
                    width: 5
                    cap: "round"
                    joint: "round"
                    joint_precision: 100
                    close: True
                Line:
                    points: root.line_b
                    width: 5
                    cap: "round"
                    joint: "round"
                    joint_precision: 100
                    close: True
                Color:
                    rgba: color_a
                Line:
                    points: root.line_a[:6] if len(root.line_a) >= 6 else []
                    width: 2
                Color:
                    rgba: color_b
                Line:
                    points: root.line_b[:6] if len(root.line_b) >= 6 else []
                    width: 2
            canvas.after:
                Color:
                    rgba: color_a
                Line:
                    points: root.line_a[:root.progress_a*2]
                    width: 5
                    cap: "round"
                    joint: "round"
                    joint_precision: 100
                Color:
                    rgba: color_b
                Line:
                    points: root.line_b[:root.progress_b*2]
                    width: 5
                    cap: "round"
                    joint: "round"
                    joint_precision: 100
                Color:
                    rgba: color_a
                Ellipse:
                    pos: root.cursor_a
                    size: 20, 20
                Color:
                    rgba: color_b
                Ellipse:
                    pos: root.cursor_b
                    size: 20, 20
